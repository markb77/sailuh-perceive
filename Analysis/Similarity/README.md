# Similarity Model: Gensim LDA

This folder contains the script for running the LDA model on text data. This specific script extracts the topics from the CVE and FD mailing lists. Also, it calculates the similarity score (between 0 and 1) between the two.

## Dependencies 

gensim, nltk, nltk.download 'stopwords'

Obs on downloading nltk stopwords, run python on a terminal and do the following:
```
>>> import nltk
>>> nltk.downloads()
```

A pop-window will appear. Select the `Corpora` Tab, and scroll down until you find the `stopwords` option. Then click download. 

You will also need as input for this script the outputs generated by the following scripts:

 * `fd_to_thread.py`: <Thread folder> 
 * `CVEDetails_crawler_v1.py`: <CVE Type .csv file>

## How to Use

```
python genism-lda.py <location of the folder containing all .txt email threads> <Number of topics> <CVE Type .csv file>
```

For example:

```
~/Desktop/perceive/Analysis/Similarity/gensim-lda.py ~/Desktop/test/body_corpus/2016/output/ 5 ~/Desktop/perceive/Analysis/Similarity/input/DoS.csv
```

## Output:

This script generates three output files (sample files put up in ‘Output’ subfolder):<br>

 * LDA_Word_Topic_distribution.csv (contains distribution of the terms in each topic of the LDA model)<br>
 * LDA_Topic_Document_distribution.csv (contains the distribution of topics and corresponding weights for each CVE entry in the vulnerability file; here the DoS.csv file)<br>
 * LDA_Document_Similarity.csv (contains the similarity value of each email thread with each topic of the LDA model)


## Notes:

 * The text-data from the vulnerability file is pre-processed/cleaned (i.e. stopwords and punctuations are removed) in this script. The text of the Full Disclosure mailing list threads is NOT pre-processed/cleaned.
 * Please NOTE that the input format clearly. Each thread of the FD mailing list is in .txt format. One text file for one thread (Use the fd_to_Threads script) 
 * The third argument is a csv file containing all CVE entries related to a particular vulnerability type. Sample file is put up in the “Input” subfolder under the name of DoS.csv 

